---
title: "my-vignette"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{my-vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(conjBayes)
```

## About conjBayes

Given data, the conjBayes packages provides functions for updating conjugate Bayesian prior distributions to the posterior distribution. There are four main functions. The first is BetaBernoulli. Let's see how it works!

```{r}
BetaBernoulli(y = c(1, 1, 0, 1, 0, 0, 0, 1), a0 = 1, b0 = 1)
```

# 


## Fundametals of Bayesian data analysis in r (Example: Probabilty that we have found a vaccine that cures the zombie outbreak)

> https://rpubs.com/klinares/443186 


# PoissonGamma Example

```{r}
data()
discoveries
library(tidyverse)

as_tibble(discoveries) %>% ggplot(aes(x=discoveries)) + geom_bar()

plot(discoveries, ylab = "Number of important discoveries", las = 1)
mean(discoveries)

range(discoveries)

qgamma(p=0.5, shape=12, rate=1)

xx <- seq(0.1,100,0.1)
plot(xx, pgamma(xx, shape=12, rate=1))
plot(xx, dgamma(xx, shape=12, rate=1))
plot(xx, dgamma(xx, shape=12, rate=1),type="l")
plot(xx, dgamma(xx, shape=12, rate=0.5),type="l")
plot(xx, dgamma(xx, shape=12, rate=2),type="l")

library(conjBayes)
GammaPoisson(y=discoveries, a0=12, b0=2)

lines(xx, dgamma(xx, shape=322, rate=102), type="l", col="blue")
plot(xx, dgamma(xx, shape=12, rate=2),type="l",xlim=c(0,20))
lines(xx, dgamma(xx, shape=322, rate=102), type="l", col="blue")
plot(xx, dgamma(xx, shape=12, rate=2),type="l",xlim=c(0,15))
lines(xx, dgamma(xx, shape=322, rate=102), type="l", col="blue")
plot(xx, dgamma(xx, shape=12, rate=2),type="l",xlim=c(0,15),ylim=c(0,1))
lines(xx, dgamma(xx, shape=322, rate=102), type="l", col="blue")
plot(xx, dgamma(xx, shape=12, rate=2),type="l",xlim=c(0,15),ylim=c(0,2))
lines(xx, dgamma(xx, shape=322, rate=102), type="l", col="blue")
plot(xx, dgamma(xx, shape=12, rate=2),type="l",xlim=c(0,15),ylim=c(0,2.5))
lines(xx, dgamma(xx, shape=322, rate=102), type="l", col="blue")
rug(discoveries)
rug(jitter(discoveries),col="red")

```



## Zombie Apocalypse (from citation...)

```{r}
set.seed(78972)
p_success <- .15 # probability of success
n_zombies <- 13 # trails

# simulate data
data <- c()
for(zombie in 1:n_zombies){
  # save if prop is between 0 & 1 and greater than our prob. of success
  data[zombie] <- runif(1, min=0, max=1) < p_success 
}

data <- as.numeric(data)
data # individual trial outcomes --> we need to use BetaBernoulli function
```


```{r}
# set the prior
# uniform prior over (0,1) is Beta(a0=1,b0=1)

BBpost <- BetaBernoulli(y=data, a0=1, b0=1)
```

# plot the posterior distribution (a Beta(a1=3, b1=12))

```{r}

bb <- seq(0.001, 0.999, 0.001)
post <- dbeta(bb, shape1 = BBpost$a1, shape2=BBpost$b1)
plot(bb, post, type="l", col="blue")
lines(bb, dbeta(bb, shape1=1, shape2=1))
abline(v=mean(data))
mean(data)
```

What if you only knew the number of "successes" out of n trials? Say you knew there were 4 successes in n=13 trials. Then use the BetaBinomial function.

```{r}

BBpost <- BetaBinomial(y=4, n=13, a0=1, b0=1)
BBpost

post <- dbeta(bb, shape1 = BBpost$a1, shape2=BBpost$b1)
plot(bb, post, type="l", col="blue")
lines(bb, dbeta(bb, shape1=1, shape2=1))
abline(v=4/13)

```


## how to create a vignette
## how to get the package pdf file (manual) 
